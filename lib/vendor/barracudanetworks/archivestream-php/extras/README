Based on PKZIP appnotes, which are included here.

